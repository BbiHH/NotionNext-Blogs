<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BbiHH 灵感工厂 | 极简创意</title>
    <!-- 引入 Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Lucide 图标库 --><script src="https://unpkg.com/lucide@latest"></script>
    <!-- 引入 Google Fonts --><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dot: #e5e7eb;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #fafafa; /* 极浅灰白 */
            /* 点阵背景图案，营造“工厂/图纸”的感觉 */
            background-image: radial-gradient(var(--bg-dot) 1px, transparent 1px);
            background-size: 24px 24px;
            min-height: 100vh;
            color: #18181b; /* Zinc-900 */
        }

        /* 隐藏滚动条但允许滚动 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
            border-color: #000;
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        /* 模态框动画 */
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .modal-animateing {
            animation: modalIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        /* 录制中的红点动画 */
        .recording-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #ef4444;
            border-radius: 50%;
            margin-right: 6px;
            animation: pulse-red 1.5s infinite;
        }
        @keyframes pulse-red {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(239, 68, 68, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="antialiased selection:bg-black selection:text-white">

    <!-- 导航栏 --><nav class="glass-nav fixed top-0 w-full z-40 px-6 py-4 flex justify-between items-center">
        <div class="flex items-center space-x-3">
            <!-- Logo: 纯黑简约风 --><div class="bg-black text-white p-2 rounded-md shadow-lg">
                <i data-lucide="box" size="20"></i>
            </div>
            <span class="text-lg font-bold tracking-tight text-black">
                BbiHH<span class="font-light text-gray-400 mx-1">|</span>灵感工厂
            </span>
        </div>
        <div class="hidden md:flex items-center space-x-8 text-sm font-medium text-gray-500">
            <button class="text-black border border-gray-200 px-5 py-2 rounded-full hover:bg-black hover:text-white transition-all text-xs font-bold uppercase tracking-wider">
                <a href="https://bbihh.top/about"> 联系作者 </a>
            </button>
        </div>
    </nav>

    <!-- 主要内容区域 --><main class="pt-28 pb-12 px-4 md:px-8 max-w-7xl mx-auto">
        
        <!-- 每日灵感 / 欢迎区 --><section class="mb-16 bg-white rounded-none md:rounded-3xl p-8 md:p-12 shadow-sm border border-gray-200 relative overflow-hidden group">
            <!-- 装饰性的极简几何线条 --><div class="absolute top-0 right-0 w-32 h-32 bg-gray-50 rounded-bl-full -mr-8 -mt-8 z-0 transition-transform group-hover:scale-110 duration-700"></div>
            
            <div class="relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-8">
                <div class="max-w-2xl">
                    <div class="flex items-center gap-2 text-gray-400 font-mono text-xs mb-4 uppercase tracking-widest">
                        <i data-lucide="terminal" size="14"></i>
                        <span>Daily Input</span>
                    </div>
                    <h1 class="text-3xl md:text-5xl font-bold text-black mb-6 leading-tight tracking-tight" id="daily-quote">
                        "Less is more."
                    </h1>
                    <p class="text-gray-500 text-lg font-light">
                        欢迎来到 <span class="font-medium text-black">BbiHH</span> 的数字车间。这里没有复杂的装饰，只有纯粹的代码逻辑与思维火花。
                    </p>
                </div>
                
                <!-- 数据看板 --><div class="bg-gray-50 p-6 rounded-xl border border-gray-100 flex flex-col items-center min-w-[150px]">
                    <div class="text-gray-300 mb-2">
                        <i data-lucide="cpu" size="32"></i>
                    </div>
                    <p class="text-4xl font-bold text-black mono-font tracking-tighter" id="total-count">0</p>
                    <p class="text-xs text-gray-400 uppercase font-bold tracking-wider mt-1">Prototypes</p>
                </div>
            </div>
        </section>

        <!-- 筛选分类 (胶囊改为黑白) --><div class="flex flex-wrap items-center justify-center md:justify-start gap-3 mb-10 overflow-x-auto no-scrollbar pb-2" id="filter-container">
            <button class="filter-btn active px-6 py-2.5 rounded-full text-sm font-medium bg-black text-white border border-black transition-all hover:shadow-lg" data-category="all">
                全部
            </button>
            <button class="filter-btn px-6 py-2.5 rounded-full text-sm font-medium bg-white text-gray-500 hover:text-black hover:border-gray-400 border border-gray-200 transition-all" data-category="animation">
                视觉实验
            </button>
            <button class="filter-btn px-6 py-2.5 rounded-full text-sm font-medium bg-white text-gray-500 hover:text-black hover:border-gray-400 border border-gray-200 transition-all" data-category="knowledge">
                思维碎片
            </button>
            <button class="filter-btn px-6 py-2.5 rounded-full text-sm font-medium bg-white text-gray-500 hover:text-black hover:border-gray-400 border border-gray-200 transition-all" data-category="tool">
                效能工具
            </button>
             <button class="filter-btn px-6 py-2.5 rounded-full text-sm font-medium bg-white text-gray-500 hover:text-black hover:border-gray-400 border border-gray-200 transition-all" data-category="game">
                微型游戏
            </button>
        </div>

        <!-- 卡片网格 --><div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-6 gap-y-10" id="projects-grid">
            <!-- 卡片将通过 JS 动态插入 --></div>

        <!-- 空状态提示 --><div id="empty-state" class="hidden text-center py-32 border border-dashed border-gray-200 rounded-2xl bg-gray-50/50">
            <div class="inline-block p-4 bg-white rounded-full mb-4 shadow-sm">
                <i data-lucide="ghost" size="32" class="text-gray-300"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-900">数据为空</h3>
            <p class="text-gray-400 text-sm">车间暂时停工，请切换其他分类。</p>
        </div>

    </main>

    <!-- 底部 --><footer class="bg-white border-t border-gray-200 py-12 mt-auto">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-2 text-black font-bold">
                <i data-lucide="box" size="16"></i>
                <span>BbiHH Factory</span>
            </div>
            <div class="text-xs text-gray-400 font-mono">
                DESIGNED BY BbiHH &middot; POWERED BY CODE
            </div>
            <div class="flex space-x-6">
                <a href="#" class="text-gray-400 hover:text-black transition-colors"><i data-lucide="github" size="18"></i></a>
                <a href="#" class="text-gray-400 hover:text-black transition-colors"><i data-lucide="twitter" size="18"></i></a>
            </div>
        </div>
    </footer>

    <!-- 模拟应用打开的模态框 --><div id="app-modal" class="fixed inset-0 z-50 hidden">
        <!-- 背景遮罩：加深一点，更沉浸 --><div class="absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        
        <!-- 模态框内容 --><div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-none">
            <div class="bg-white w-full max-w-6xl h-[90vh] rounded-xl shadow-2xl border border-gray-200 flex flex-col pointer-events-auto modal-animateing relative overflow-hidden">
                
                <!-- 模态框头部：极简线条 --><div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white z-10">
                    <div class="flex items-center gap-4">
                        <!-- 黑色图标块 --><div id="modal-icon" class="p-2 rounded bg-black text-white"></div>
                        <div>
                            <h2 id="modal-title" class="text-xl font-bold text-black tracking-tight">标题</h2>
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-green-500"></span>
                                <p class="text-xs text-gray-400 font-mono uppercase">Running</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧操作栏 --><div class="flex items-center gap-3">
                        <button id="record-btn" class="group flex items-center gap-2 px-4 py-2 rounded-md text-gray-500 hover:bg-black hover:text-white transition-all text-xs font-bold border border-gray-200" onclick="toggleRecording()">
                            <i data-lucide="aperture" size="16" class="group-hover:rotate-180 transition-transform duration-500"></i>
                            <span id="record-text" class="hidden sm:inline">REC</span>
                        </button>
                        
                        <div class="w-px h-6 bg-gray-200 mx-1"></div>

                        <button class="text-gray-400 hover:text-black transition-colors p-2" onclick="toggleFullscreen()" title="全屏">
                            <i data-lucide="maximize" size="18"></i>
                        </button>
                        <button class="text-gray-400 hover:bg-red-50 hover:text-red-600 p-2 rounded-md transition-colors" onclick="closeModal()" title="关闭">
                            <i data-lucide="x" size="20"></i>
                        </button>
                    </div>
                </div>

                <!-- 模态框主体 --><div class="flex-1 bg-gray-50 relative flex flex-col items-center justify-center overflow-hidden">
                    
                    <iframe id="project-iframe" class="w-full h-full hidden bg-white" frameborder="0"></iframe>

                    <!-- 模拟占位符 --><div id="modal-content-placeholder" class="text-center p-12 w-full max-w-3xl">
                        <div class="inline-block mb-8">
                            <i data-lucide="loader" size="40" class="text-black animate-spin"></i>
                        </div>
                        
                        <!-- 模拟的演示内容框：黑白线框风格 --><div class="bg-white rounded-lg border border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] p-8 text-left relative hidden" id="mock-demo-content">
                            <div class="absolute -top-3 left-4 bg-black text-white px-3 py-0.5 text-xs font-mono uppercase">Preview Mode</div>
                            
                            <h4 class="text-2xl font-bold text-black mb-4 tracking-tight" id="demo-title"></h4>
                            <p class="text-gray-600 leading-relaxed mb-6 font-light" id="demo-desc"></p>
                            
                            <div class="h-48 bg-gray-50 rounded border border-dashed border-gray-300 flex flex-col items-center justify-center text-gray-400 gap-2">
                                <i data-lucide="mouse-pointer-2" size="24"></i>
                                <span class="text-xs font-mono">Interactive Area</span>
                            </div>

                            <div class="mt-6 flex gap-2">
                                <div class="px-3 py-1 bg-gray-100 text-gray-500 text-xs rounded font-mono">HTML</div>
                                <div class="px-3 py-1 bg-gray-100 text-gray-500 text-xs rounded font-mono">CSS</div>
                                <div class="px-3 py-1 bg-gray-100 text-gray-500 text-xs rounded font-mono">JS</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 1. 项目数据 - **新增 `cover` 属性**
        const projects = [
            {
                id: 1,
                title: "太阳系微缩模型", 
                url: "./projects/solar.html",
                desc: "纯 CSS+JS 实现的微缩物理模型。点击星体可查看参数。",
                category: "knowledge",
                icon: "orbit",
                cover: "./covers/solar.png", // 示例封面图
                tags: ["Physics", "3D"],
                date: "2023-10-05"
            },
            {
                id: 2,
                title: "4-7-8 呼吸冥想",
                desc: "4-7-8 呼吸冥想引导。极简的视觉律动。",
                url: "./projects/breath.html",
                category: "tool",
                icon: "wind",
                cover: "./covers/breath.png", // 示例封面图
                tags: ["Health", "Zen"],
                date: "2023-10-08"
            },
            {
                id: 3,
                title: "斐波那契螺旋",
                desc: "黄金分割螺旋线的自动生成算法演示。",
                url: "./projects/fib.html",
                category: "animation",
                icon: "webhook", 
                cover: "./covers/fib.png", // 示例封面图
                tags: ["Math", "Geometry"],
                date: "2023-10-12"
            },
            {
                id: 4,
                title: "番茄工作法计时器",
                desc: "专注计时器。每完成一个番茄钟，生成一个像素点。",
                url: "./projects/pomodoro.html",
                category: "tool",
                icon: "hourglass",
                cover: "./covers/fq.png", // 示例封面图
                tags: ["Productivity", "Pixel"],
                date: "2023-10-15"
            },
            {
                id: 5,
                title: "色彩心理学",
                desc: "交互式色卡与情绪映射。",
                category: "knowledge",
                url: "./projects/color.html",
                icon: "palette",
                cover: "./covers/color.png", // 示例封面图
                tags: ["Design", "Psych"],
                date: "2023-10-20"
            },
            {
                id: 6,
                title: "什么是心流",
                desc: "关于“心流”状态的视觉化解释。",
                category: "knowledge",
                url: "./projects/xin.html",
                icon: "zap", 
                cover: "./covers/xin.png", // 示例封面图
                tags: ["Focus", "Psych"],
                date: "2023-10-05"
            }
        ];

        const quotes = [
            "“Simple is the new smart.”",
            "“秩序是自由的第一条件。”",
            "“代码是逻辑的诗篇。”",
            "“保持饥饿，保持愚蠢。”",
            "“灵感源于严谨的思考。”"
        ];

        document.addEventListener('DOMContentLoaded', () => {
            renderProjects(projects);
            setupFilters();
            lucide.createIcons();
            document.getElementById('total-count').textContent = projects.length.toString().padStart(2, '0'); // 补零，更有机械感
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('daily-quote').textContent = randomQuote;
        });

        function renderProjects(data) {
            const grid = document.getElementById('projects-grid');
            grid.innerHTML = '';
            if (data.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
                return;
            } else {
                document.getElementById('empty-state').classList.add('hidden');
            }
            data.forEach(project => {
                const card = document.createElement('div');
                card.className = 'group bg-white rounded-xl border border-gray-200 overflow-hidden card-hover cursor-pointer flex flex-col h-[280px]';
                card.onclick = () => openModal(project);
                
                const tagsHtml = project.tags.map(tag => 
                    `<span class="text-[10px] px-2 py-1 border border-gray-200 text-gray-500 uppercase tracking-wider font-mono rounded hover:bg-black hover:text-white transition-colors">${tag}</span>`
                ).join('');

                // **修改此处：根据是否有封面图来渲染不同的内容**
                const mediaContent = project.cover 
                    ? `<img src="${project.cover}" alt="${project.title}封面" class="w-full h-full object-cover transition-transform group-hover:scale-105 duration-500">`
                    : `<i data-lucide="${project.icon}" size="40" class="text-gray-800 opacity-80 group-hover:scale-110 group-hover:text-black transition-all duration-500"></i>`;

                card.innerHTML = `
                    <div class="h-2/5 bg-gray-50 border-b border-gray-100 relative flex items-center justify-center overflow-hidden group-hover:bg-gray-100 transition-colors">
                        ${mediaContent}
                        <!-- 右上角箭头 --><div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0">
                             <i data-lucide="arrow-up-right" size="20" class="text-black"></i>
                        </div>
                    </div>
                    
                    <div class="p-6 flex-1 flex flex-col justify-between">
                        <div>
                            <h3 class="text-lg font-bold text-gray-900 mb-2 group-hover:underline decoration-2 underline-offset-4">${project.title}</h3>
                            <p class="text-gray-500 text-xs leading-relaxed line-clamp-3">${project.desc}</p>
                        </div>
                        <div class="flex items-center gap-2 pt-4">
                            ${tagsHtml}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
            lucide.createIcons();
        }

        function setupFilters() {
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    buttons.forEach(b => {
                        // Reset styles
                        b.classList.remove('bg-black', 'text-white', 'border-black');
                        b.classList.add('bg-white', 'text-gray-500', 'border-gray-200', 'hover:text-black');
                    });
                    // Active style
                    btn.classList.remove('bg-white', 'text-gray-500', 'border-gray-200', 'hover:text-black');
                    btn.classList.add('bg-black', 'text-white', 'border-black');
                    
                    const category = btn.dataset.category;
                    if (category === 'all') {
                        renderProjects(projects);
                    } else {
                        const filtered = projects.filter(p => p.category === category);
                        renderProjects(filtered);
                    }
                });
            });
        }

        function openModal(project) {
            const modal = document.getElementById('app-modal');
            const title = document.getElementById('modal-title');
            const icon = document.getElementById('modal-icon');
            const iframe = document.getElementById('project-iframe');
            const placeholder = document.getElementById('modal-content-placeholder');
            const mockContent = document.getElementById('mock-demo-content');
            const demoTitle = document.getElementById('demo-title');
            const demoDesc = document.getElementById('demo-desc');
            
            title.textContent = project.title;
            icon.innerHTML = `<i data-lucide="${project.icon}" size="20"></i>`;
            modal.classList.remove('hidden');
            lucide.createIcons();

            if (project.url) {
                iframe.src = project.url;
                iframe.classList.remove('hidden');
                placeholder.classList.add('hidden');
            } else {
                iframe.classList.add('hidden');
                iframe.src = ""; 
                placeholder.classList.remove('hidden');
                demoTitle.textContent = project.title;
                demoDesc.textContent = project.desc;
                mockContent.classList.add('hidden'); 
                setTimeout(() => {
                    mockContent.classList.remove('hidden');
                    mockContent.classList.add('modal-animateing'); 
                }, 500); // 稍微快一点
            }
        }

        function closeModal() {
            const modal = document.getElementById('app-modal');
            modal.classList.add('hidden');
            const iframe = document.getElementById('project-iframe');
            if (iframe) iframe.src = "";
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                toggleRecording();
            }
        }

        function toggleFullscreen() {
            const elem = document.getElementById('app-modal').querySelector('.modal-animateing');
            if (!document.fullscreenElement) {
                elem.requestFullscreen().catch(err => console.log(err));
            } else {
                document.exitFullscreen();
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        // --- 录制功能逻辑 (保持不变，仅修改按钮样式的 DOM 操作) ---
        let mediaRecorder;
        let recordedChunks = [];
        let isRecording = false;

        async function toggleRecording() {
            const btn = document.getElementById('record-btn');
            const btnText = document.getElementById('record-text');
            const icon = btn.querySelector('i');

            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getDisplayMedia({ video: { mediaSource: 'screen' }, audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.ondataavailable = e => { if (e.data.size > 0) recordedChunks.push(e.data); };
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: "video/webm" });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement("a");
                        a.href = url; a.download = `BbiHH_Capture_${Date.now()}.webm`; a.click();
                        
                        recordedChunks = [];
                        isRecording = false;
                        resetRecordButton(btn, btnText, icon);
                        stream.getTracks().forEach(track => track.stop());
                    };
                    stream.getVideoTracks()[0].onended = () => { if (mediaRecorder.state !== 'inactive') mediaRecorder.stop(); };
                    mediaRecorder.start();
                    isRecording = true;
                    
                    // 样式：录制中变为红色边框+闪烁文字
                    btn.classList.remove('text-gray-500', 'hover:bg-black', 'hover:text-white');
                    btn.classList.add('text-red-600', 'bg-white', 'border-red-600');
                    btnText.innerHTML = 'STOP';
                    icon.setAttribute('data-lucide', 'square'); 
                    lucide.createIcons();

                } catch (err) {
                    console.error(err);
                }
            } else {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') mediaRecorder.stop();
            }
        }

        function resetRecordButton(btn, btnText, icon) {
            btn.classList.remove('text-red-600', 'bg-white', 'border-red-600');
            btn.classList.add('text-gray-500', 'hover:bg-black', 'hover:text-white');
            btnText.innerHTML = 'REC';
            icon.setAttribute('data-lucide', 'aperture');
            lucide.createIcons();
        }
    </script>
</body>
</html>